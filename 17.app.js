(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{46:function(s,e,t){"use strict";t.r(e);var i=t(1),a=[],l=t(34);var n=[function(s,e,t){return["table",e,"{table-layout:fixed;width:100%}.rare",e,"{color:red;font-weight:700}"].join("")}],r=t(21);function o(s,e,t,a){const{h:l,d:n,c:o,t:c,k:d,b:g,i:h}=s,{_m0:p,_m1:y}=a;return[e.sightings?l("div",{classMap:{"slds-size_1-of-1":!0},key:0},[l("div",{classMap:{"slds-card":!0},key:1},[l("div",{classMap:{"slds-card__header":!0},key:2},[l("div",{classMap:{"slds-media":!0,"slds-media--center":!0,"slds-has-flexi-truncate":!0},key:3},[l("span",{classMap:{"slds-icon_container":!0,"slds-icon-standard-forecasts":!0},attrs:{title:"Description of icon when needed"},key:4},[l("svg",{classMap:{"slds-icon":!0},attrs:{"aria-hidden":"true"},key:5},[l("use",{attrs:{"xlink:href":Object(i.sanitizeAttribute)("use","http://www.w3.org/2000/svg","xlink:href","resources/SLDS/icons/standard-sprite/svg/symbols.svg#forecasts")},key:6},[])])]),l("div",{classMap:{"slds-media__body":!0},key:7},[l("h2",{classMap:{"slds-p-left_small":!0,"slds-text-heading--small":!0,"slds-wrap":!0},key:8},[n(e.header),o("lightning-helptext",r.a,{classMap:{"slds-var-p-left_small":!0},props:{content:"Click on a species to see a list of sightings for that species."},key:9},[])])])])]),l("div",{classMap:{"slds-card__body":!0},key:10},[l("div",{classMap:{"slds-scrollable--y":!0},styleMap:{"max-height":"450px"},key:11},[e.showLocations?l("table",{classMap:{"slds-table":!0,"slds-table_cell-buffer":!0,"slds-table_bordered":!0,"slds-table_col-bordered":!0},key:12},[l("thead",{key:13},[l("tr",{classMap:{"slds-text-heading--label":!0},key:14},[l("th",{attrs:{scope:"col"},key:15},[l("span",{classMap:{"slds-truncate":!0},key:16},[c("Species")])]),l("th",{attrs:{scope:"col"},key:17},[l("span",{classMap:{"slds-truncate":!0},key:18},[c("Location")])])])]),l("tbody",{key:19},h(e.sightingList,(function(s){return l("tr",{classMap:{"slds-hint-parent":!0},attrs:{"data-id":s.id},key:d(20,s.id),on:{click:p||(a._m0=g(e.handleSightingClick))}},[l("td",{className:s.class,key:21},[n(s.name)]),l("td",{classMap:{"slds-cell-wrap":!0},key:22},[n(s.locations)])])})))]):null,e.showLocations?null:l("table",{classMap:{"slds-table":!0,"slds-table_cell-buffer":!0,"slds-table_bordered":!0,"slds-table_col-bordered":!0},key:23},[l("thead",{key:24},[l("tr",{classMap:{"slds-text-heading--label":!0},key:25},[l("th",{attrs:{scope:"col"},key:26},[l("span",{classMap:{"slds-truncate":!0},key:27},[c("Species")])]),l("th",{attrs:{scope:"col"},key:28},[l("span",{classMap:{"slds-truncate":!0},key:29},[c("Scientific Name")])])])]),l("tbody",{key:30},h(e.sightingList,(function(s){return l("tr",{classMap:{"slds-hint-parent":!0},attrs:{"data-id":s.id},key:d(31,s.id),on:{click:y||(a._m1=g(e.handleSightingClick))}},[l("td",{classMap:{"slds-cell-wrap":!0},key:32},[n(s.name)]),l("td",{classMap:{"slds-cell-wrap":!0},key:33},[l("i",{key:34},[n(s.scientific)])])])})))])])])])]):null]}var c=Object(i.registerTemplate)(o);o.stylesheets=[],n&&o.stylesheets.push.apply(o.stylesheets,n),o.stylesheetTokens={hostAttribute:"my-my-sightings_sightings-host",shadowAttribute:"my-my-sightings_sightings"};class d extends i.LightningElement{constructor(...s){super(...s),this.sightings=void 0,this.header=void 0,this.viewtype=void 0,this.rarebirds=new Set(JSON.parse(sessionStorage.getItem("rarebirds")).map(s=>s["Scientific Name"]))}get sightingList(){if(0===this.sightings.length)return[{id:"0",name:"None"}];let s=[];return new Set(this.sightings.map(s=>s.comName)).forEach(e=>{let t=this.sightings.filter(s=>s.comName===e),i="us"===this.viewtype?[...new Set(t.map(s=>`${s.subnational2Name}, ${s.subnational1Name}`))].sort():new Set(t.map(s=>s.subnational2Name));s.push({id:t[0].speciesCode,name:e,locations:"us"===this.viewtype?Array.from(i).join("; "):Array.from(i).join(", "),mostRecent:Math.max(...t.map(s=>new Date(s.obsDt))),scientific:t[0].sciName,class:this.rarebirds.has(t[0].sciName)?"slds-cell-wrap rare":"slds-cell-wrap"})}),s.sort((s,e)=>s.name>e.name?1:-1)}handleSightingClick(s){const e=s.currentTarget.dataset.id,t=this.sightings.filter(s=>s.speciesCode===e);this.dispatchEvent(new CustomEvent("sightingselected",{detail:t}))}get showLocations(){return"nearby"!==this.viewtype}}Object(i.registerDecorators)(d,{publicProps:{sightings:{config:0},header:{config:0},viewtype:{config:0}},fields:["rarebirds"]});var g=Object(i.registerComponent)(d,{tmpl:c});var h=[function(s,e,t){return[".slds-card__footer",e,"{height:250px}"].join("")}];function p(s,e,t,i){const{d:a,h:l,c:n,t:o,k:c,b:d,i:g}=s,{_m0:h}=i;return[e.showSightings?l("article",{classMap:{"slds-card":!0},key:0},[l("div",{classMap:{"slds-card__header":!0,"slds-grid":!0},key:1},[l("header",{classMap:{"slds-media":!0,"slds-media_center":!0,"slds-has-flexi-truncate":!0},key:2},[l("div",{classMap:{"slds-media__body":!0},key:3},[l("h2",{classMap:{"slds-card__header-title":!0},key:4},[l("a",{classMap:{"slds-card__header-link":!0,"slds-truncate":!0},attrs:{href:"#",title:"Accounts"},key:5},[l("span",{key:6},[a(e.header)])]),n("lightning-helptext",r.a,{classMap:{"slds-var-p-left_small":!0},props:{content:"Click on a sighting to see a map for the siting."},key:7},[])])])])]),l("div",{classMap:{"slds-card__body":!0,"slds-card__body_inner":!0},key:8},[l("div",{classMap:{"slds-scrollable--y":!0},styleMap:{"max-height":"450px"},key:9},[l("table",{classMap:{"slds-table":!0,"slds-table_cell-buffer":!0,"slds-table_bordered":!0,"slds-table_col-bordered":!0},key:10},[l("thead",{key:11},[l("tr",{classMap:{"slds-text-heading--label":!0},key:12},[l("th",{attrs:{scope:"col"},key:13},[l("span",{classMap:{"slds-truncate":!0},key:14},[o("Date/Time")])]),l("th",{styleMap:{width:"20rem"},attrs:{scope:"col"},key:15},[l("span",{classMap:{"slds-truncate":!0},key:16},[o("Site Name")])]),e.showLocations?l("th",{attrs:{scope:"col"},key:17},[l("span",{classMap:{"slds-truncate":!0},key:18},[o("Location")])]):null,e.showLocations?l("th",{attrs:{scope:"col"},key:19},[l("span",{classMap:{"slds-truncate":!0},key:20},[o("Sighted By")])]):null,l("th",{attrs:{scope:"col"},key:21},[l("span",{classMap:{"slds-truncate":!0},key:22},[o("Quanitity")])])])]),l("tbody",{key:23},g(e.sightingList,(function(s){return l("tr",{classMap:{"slds-hint-parent":!0},attrs:{"data-id":s.id},key:c(24,s.id),on:{click:h||(i._m0=d(e.handleSightingClick))}},[l("td",{classMap:{"slds-cell-wrap":!0},key:25},[a(s.date)]),l("td",{classMap:{"slds-cell-wrap":!0},key:26},[a(s.location)]),e.showLocations?l("td",{classMap:{"slds-cell-wrap":!0},key:27},[a(s.locality)]):null,e.showLocations?l("td",{classMap:{"slds-cell-wrap":!0},key:28},[a(s.by)]):null,l("td",{classMap:{"slds-cell-wrap":!0},key:29},[a(s.quantity)])])})))])])]),l("footer",{classMap:{"slds-card__footer":!0},key:30},[e.showMap?l("iframe",{styleMap:{border:"0"},attrs:{width:"100%",height:"100%",frameborder:"0",src:e.mapUrl,allowfullscreen:""},key:31},[]):null])]):null]}var y=Object(i.registerTemplate)(p);p.stylesheets=[],h&&p.stylesheets.push.apply(p.stylesheets,h),p.stylesheetTokens={hostAttribute:"my-my-sightingsDetails_sightingsDetails-host",shadowAttribute:"my-my-sightingsDetails_sightingsDetails"};class u extends i.LightningElement{constructor(...s){super(...s),this.sightings=void 0,this.lat=void 0,this.lon=void 0,this.viewtype=void 0}get showSightings(){return void 0!==this.sightings&&this.sightings.length>0}get header(){return`${this.sightings[0].comName} (${this.sightings[0].sciName})`}get sightingList(){let s=[];return this.sightings.forEach(e=>{s.findIndex(s=>s.id===e.obsId)<0&&s.push({id:e.obsId,location:e.locName,locality:void 0===e.subnational2Name?"":`${e.subnational2Name}, ${e.subnational1Name}`,quantity:e.howMany,by:e.userDisplayName,date:e.obsDt})}),s}get mapUrl(){return`https://www.google.com/maps/embed/v1/place?key=AIzaSyCB3Q5szLx_1-UE-WIkFSgA3fFi7-KWFAM&q=${this.lat},${this.lon}&zoom=15`}get showMap(){return this.lat&&this.lon}handleSightingClick(s){const e=s.currentTarget.dataset.id,t=this.sightings.find(s=>s.obsId===e);this.lat=t.lat,this.lon=t.lng}get showLocations(){return"nearby"!==this.viewtype}}Object(i.registerDecorators)(u,{publicProps:{sightings:{config:0},lat:{config:0},lon:{config:0},viewtype:{config:0}}});var b=Object(i.registerComponent)(u,{tmpl:y});function m(s,e,t,i){const{b:a,c:n,h:r}=s,{_m0:o,_m1:c}=i;return[r("div",{classMap:{"slds-grid":!0,"slds-wrap":!0,"slds-gutters":!0,"slds-p-left_medium":!0,"slds-p-right_medium":!0,main:!0,"slds-p-bottom_xx-large":!0,"slds-p-top_medium":!0},key:0},[r("div",{classMap:{"slds-col":!0,"slds-large-size_1-of-3":!0,"slds-small-size_1-of-1":!0,"slds-p-left_x-small":!0,"slds-text-align_center":!0,"slds-p-bottom_small":!0},key:1},[n("lightning-radio-group",l.a,{props:{name:"radioGroup",options:e.options,value:e.view,type:"button"},key:2,on:{change:o||(i._m0=a(e.handleSightingsChange))}},[])]),r("div",{classMap:{"slds-col":!0,"slds-large-size_2-of-3":!0,"slds-small-size_1-of-1":!0},key:3},[]),r("div",{classMap:{"slds-col":!0,"slds-large-size_1-of-3":!0,"slds-small-size_1-of-1":!0,"slds-p-left_x-small":!0},key:4},[r("div",{key:5},[]),r("div",{key:6},[n("my-sightings",g,{props:{sightings:e.sightings,header:e.sightingsHeader,viewtype:e.view},key:7,on:{sightingselected:c||(i._m1=a(e.handleSightingsSelected))}},[])])]),r("div",{classMap:{"slds-col":!0,"slds-large-size_2-of-3":!0,"slds-small-size_1-of-1":!0},key:8},[n("my-sightings-details",b,{props:{sightings:e.selectedSightings,viewtype:e.view},key:9},[])])])]}var k=Object(i.registerTemplate)(m);m.stylesheets=[],a&&m.stylesheets.push.apply(m.stylesheets,a),m.stylesheetTokens={hostAttribute:"my-my-resources_resources-host",shadowAttribute:"my-my-resources_resources"};var v=t(15);class S extends i.LightningElement{constructor(...s){super(...s),this.localSightings=void 0,this.localSightingsDaysBack=3,this.stateSightings=void 0,this.nearbySightings=void 0,this.usSightings=void 0,this.vaSightingsDaysBack=1,this.selectedSightings=[],this.nearbySelected=!1,this.localSelected=!0,this.stateSelected=!1,this.customSelected=!1,this.view="local"}connectedCallback(){this.getLocalSightings(),this.getVirginiaNotableSightings(),navigator.geolocation&&this.getNearbyObservations(),this.getUsNotableSightings()}get localSightingsHeader(){return`Notable Fredericksburg Region Sightings for the past ${this.localSightingsDaysBack} days`}getLocalSightings(){const s={lat:38.31,long:-77.46,daysBack:this.localSightingsDaysBack};Object(v.c)(s).then(s=>{this.localSightings=s})}getVirginiaNotableSightings(){const s={regionCode:"US-VA",daysBack:this.vaSightingsDaysBack};Object(v.e)(s).then(s=>{this.stateSightings=s})}getNearbyObservations(){navigator.geolocation.getCurrentPosition(s=>{const e={lat:s.coords.latitude,long:s.coords.longitude};Object(v.d)(e).then(s=>{this.nearbySightings=s})})}getUsNotableSightings(){const s={regionCode:"US",daysBack:this.vaSightingsDaysBack};Object(v.e)(s).then(s=>{this.usSightings=s})}get stateSightingsHeader(){return"Notable Virginia Sightings for the past day"}get nearbySightingsHeader(){return"Nearby Sightings for the past 7 days"}get usSightingsHeader(){return"Notable United States Sightings for the past day"}handleSightingsSelected(s){this.selectedSightings=s.detail;const e=this.template.querySelector("my-sightings-details");e.lat=void 0,e.lon=void 0}handleSightingsChange(s){this.view=s.target.value,this.selectedSightings=void 0,["nearby","local","state"].forEach(s=>{this[s+"Selected"]=!1}),this[this.view+"Selected"]=s.target.checked}get sightings(){return this[this.view+"Sightings"]}get sightingsHeader(){return this[this.view+"SightingsHeader"]}get nearbyDisabled(){return!navigator.geolocation}get options(){return[{label:"Nearby",value:"nearby"},{label:"Local",value:"local"},{label:"Virginia",value:"state"},{label:"United States",value:"us"}]}}Object(i.registerDecorators)(S,{fields:["localSightings","localSightingsDaysBack","stateSightings","nearbySightings","usSightings","vaSightingsDaysBack","selectedSightings","nearbySelected","localSelected","stateSelected","customSelected","view"]});e.default=Object(i.registerComponent)(S,{tmpl:k})}}]);